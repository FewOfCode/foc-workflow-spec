### 通用属性

通用属性指所有的基础步骤所共有的属性,跟基础的步骤的类型无关.具体参考以下表格:

| 属性名称          | 类型   | 描述                                                                                         | 是否必填 | 默认值 |
| ----------------- | ------ | -------------------------------------------------------------------------------------------- | -------- | ------ |
| ID                | UUID   | 节点的唯一 ID                                                                                | 是       |
| Pre               | UUID   | 同级下上一个节点 ID                                                                          | 是       | null   |
| Next              | UUID   | 同级下上一个节点 ID                                                                          | 是       | null   |
| ContainID         | UUID   | 如果处于循环/条件/异常容器中的组件,则对应该容器的 ID                                         | 是       | root   |
| Name              | string | 节点名称                                                                                     | 是       |
| Skip              | bool   | 忽略该节点                                                                                   | 是       | false  |
| Description       | string | 节点描述                                                                                     | 是       | null   |
| DelayBeforeExec   | int    | 执行前延时                                                                                   | 是       | 0      |
| DelayAfterExec    | int    | 执行后延时                                                                                   | 是       | 0      |
| ExceptionStrategy | string | 异常策略,暂时提供 1.retry(重试) 2.goto(跳转) 3.exit(停止)                                    | 是       | exit   |
| RetryParams       | map    | 异常策略为 retry 时的参数                                                                    | 否       | {}     |
| ExceptionParams   | map    | 异常策略参数                                                                                 | 否       | {}     |
| Type              | string | 节点类型 start:开始 end:结束 task:普通节点 loop:循环容器 if:条件容器 break/continue 内置节点 | 是       | task   |

#### 基础节点

基础步骤即为类型为 task 的节点,反映到 air-bot 中为对应一个组件功能，除了继承基础属性外，额外增加以下属性

| 属性名称  | 类型   | 描述                 | 是否必填 | 默认值 |
| --------- | ------ | -------------------- | -------- | ------ |
| component | string | 节点对应的组件包调用 | 是       |
| Inputs    | map    | 输入参数字典         | 是       | {}     |
| Outputs   | map    | 输出参数字典         | 是       | {}     |

#### 开始节点

基础步骤即为类型为 start 的节点,反映到 air-bot 中为对应开始节点

#### 结束节点

基础步骤即为类型为 end 的节点,反映到 air-bot 中为对应结束节点

### 异常策略

节点的异常策略目前有 3 种，分别为:

- retry
  retry 的参数对应 RetryParams 参数字段.具体参数为:

| 属性名称        | 类型 | 描述     | 是否必填 | 默认值 |
| --------------- | ---- | -------- | -------- | ------ |
| intervalSeconds | int  | 重试间隔 | 否       | 0      |
| retryCount      | int  | 重试次数 | 是       | 1      |

- goto
  异常时跳转到某个节点.具体参数为:

| 属性名称 | 类型 | 描述          | 是否必填 | 默认值 |
| -------- | ---- | ------------- | -------- | ------ |
| nodeID   | uuid | 跳转的节点 ID | 是       | end    |

- exit
  异常时直接退出，无参数

### 普通节点输入输出

普通节点对应的组件需要输入，同时运行完毕后也有对应的输出.即返回值,具体结构如下:

- 输入
  输入为一个 **[]map**的结构，map 的结构如下:

| 属性名称 | 类型   | 描述   | 是否必填 | 默认值 |
| -------- | ------ | ------ | -------- | ------ |
| name     | string | 参数名 | 是       |
| default  | any    | 默认值 | 否       | null   |

- 输出
  输出为一个 **[]string** 的格式，即为接受节点返回值的参数名称

### 三种节点对应的 JSON 格式.

- 开始节点

```json
{
  "Id": "xxx",
  "Pre": null,
  "Next": "xxxx",
  "ContainId": "root",
  "Name": "开始",
  "Skip": false,
  "Description": "开始节点",
  "DelayBeforeExec": 0,
  "DelayAfterExec": 0,
  "ExceptionStrategy": "exit",
  "ExceptionParams": {},
  "Type": "start"
}
```

- 结束节点

```json
{
  "Id": "xxx",
  "Pre": null,
  "Next": "xxxx",
  "ContainId": "root",
  "Name": "结束",
  "Skip": false,
  "Description": "结束节点",
  "DelayBeforeExec": 0,
  "DelayAfterExec": 0,
  "ExceptionStrategy": "exit",
  "ExceptionParams": {},
  "Type": "end"
}
```

- 普通节点

```json
{
  "Id": "xxx",
  "Pre": null,
  "Next": "xxxx",
  "ContainId": "root",
  "Name": "节点一",
  "Skip": false,
  "Description": "开始节点",
  "DelayBeforeExec": 0,
  "DelayAfterExec": 0,
  "ExceptionStrategy": "retry",
  "ExceptionParams": {},
  "RetryParams": {
    "IntervalSeconds": 10,
    "RetryCount": 1
  },

  "Component": "builtin.sleep",
  "Inputs": [
    {
      "Name": "seconds",
      "Default": 3
    }
  ],
  "Outputs":{}，
  "Type": "task"
}
```

### 流程控制节点

#### continue

continue 可用于循环容器中,会直接进入下次循环

#### break

break 同样可用于循环容器中,会直接跳出当前循环容器

#### 流程控制节点对应的 JSON 表达

- break

```json
{
  "Id": "xxx",
  "Pre": null,
  "Next": "xxxx",
  "ContainId": "root",
  "Name": "break节点",
  "Skip": false,
  "Description": "break节点",
  "Type": "break"
}
```

- continue

```json
{
  "Id": "xxx",
  "Pre": null,
  "Next": "xxxx",
  "ContainId": "root",
  "Name": "continue节点",
  "Skip": false,
  "Description": "continue节点",
  "Type": "continue"
}
```
